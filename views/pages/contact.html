<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Contact — Elite Travel & Tour</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="description" content="Contact Elite Travel & Tour. Reach us for visa, Work & Pay, and flight support with a secure, tracked contact form."/>
  <link rel="stylesheet" href="/css/base.css">
  <link rel="stylesheet" href="/css/layout.css">
  <link rel="stylesheet" href="/css/components.css">
  <link rel="stylesheet" href="/css/pages.css">
  <link rel="stylesheet" href="/css/index.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <!-- Standard ICO -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">

<!-- Or PNG -->
<link rel="icon" href="/favicon.png" type="image/png">

<!-- Optional: SVG -->
<link rel="icon" href="/favicon.svg" type="image/svg+xml">
<style>

    .pill-soft{
      display:inline-flex; align-items:center; gap:.35rem;
      padding:.18rem .55rem; border-radius:999px;
      background:#f9fafb; border:1px solid var(--gray-200);
      font-size:.8rem; color:#92400e;
    }

    /* Form */
    form.list{
      display:grid; gap:.75rem;
      margin-top:.75rem;
    }
    .field-label{
      font-size:.85rem; font-weight:600; color:var(--brand); margin-bottom:.15rem;
    }
    .input,.textarea{
      width:100%; padding:.7rem .8rem;
      border:1px solid var(--gray-300); border-radius:10px;
      font-size:.95rem; background:#093bb184;
      transition:border-color .12s, box-shadow .12s;
    }
    .input:focus,.textarea:focus{
      outline:none; border-color:var(--brand);
      box-shadow:0 0 0 2px rgba(0,119,204,.18);
    }
    .textarea{ min-height:140px; resize:vertical; }
    .small-text{ font-size:.85rem; color: var(--warning); }

    .hint{ font-size:.85rem; color:var(--brand); }

    .error-text{ font-size:.82rem; color:var(--danger); }
    .success-text{ font-size:.85rem; color:var(--success); }

    /* Contact info */
    .contact-info{
      display:grid; gap:.75rem;
      grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
      margin-top:1.2rem;
      color: var(--brand);
    }
    .contact-info div{
      background:#fff; border:1px solid var(--gray-200); border-radius:10px;
      padding:.75rem; box-shadow:var(--shadow);
      display:flex; align-items:flex-start; gap:.6rem;
      font-size:.9rem;
      color: var(--brand);
    }
    .contact-info i{ color:var(--brand); margin-top:.1rem; }

  </style>
</head>
<body>
  <!-- Nav -->
  <nav aria-label="Primary">
    <div class="wrap">
      <a class="logo" href="/"><img src="/assets/logo/logo.png" alt="Elite Travel & Tour"></a>
      <ul class="primary">
        <li><a href="/views/pages/index.html"><i class="fa fa-house"></i> Home</a></li>
        <li><a href="/views/pages/services.html"><i class="fa fa-suitcase"></i> Services</a></li>
        <li><a href="/views/pages/work-and-pay.html"><i class="fa fa-briefcase"></i> Work & Pay</a></li>
        <li><a href="/views/pages/appointment.html"><i class="fa fa-calendar"></i> Book</a></li>
        <li><a href="/views/pages/contact.html" class="active"><i class="fa fa-envelope"></i> Contact</a></li>
        <li><a href="/views/pages/about.html"><i class="fa fa-circle-info"></i> About</a></li>
      </ul>
      <div class="nav-right">
        <button id="bellBtn" class="btn outline bell" aria-label="Notifications">
          <i class="fa-regular fa-bell"></i>
          <span id="bellCount" class="count hidden">0</span>
        </button>
        <span id="authStatus" class="auth-pill" style="display:none;">
          <i class="fa fa-user-check"></i><span class="auth-text">Guest</span>
        </span>
        <button id="loginBtn" class="btn outline"><i class="fa fa-right-to-bracket"></i> Login</button>
        <button id="profileBtn" class="btn outline" style="display:none"><i class="fa fa-user"></i></button>
        <button id="logoutBtn" class="btn outline" style="display:none"><i class="fa fa-right-from-bracket"></i> </button>
        <button id="menuToggle" class="menu-toggle" aria-expanded="false"><i class="fa fa-bars"></i></button>
      </div>
    </div>

    <!-- Mobile panel -->
    <div id="mobilePanel" class="mobile-panel">
      <div class="block">
        <a href="/views/pages/index.html"><i class="fa fa-house"></i> Home</a>
        <a href="/views/pages/services.html"><i class="fa fa-suitcase"></i> Services</a>
        <a href="/views/pages/work-and-pay.html"><i class="fa fa-briefcase"></i> Work & Pay</a>
        <a href="/views/pages/appointment.html"><i class="fa fa-calendar"></i> Book</a>
        <a href="/views/pages/contact.html" class="active"><i class="fa fa-envelope"></i> Contact</a>
        <a href="/views/pages/about.html"><i class="fa fa-circle-info"></i> About</a>
      </div>
      <div class="block">
        <span class="auth-pill"><i class="fa fa-user"></i><span id="mobileAuthText">Guest</span></span>
        <div class="toolbar">
          <button id="mobileLoginBtn" class="btn brand"><i class="fa fa-right-to-bracket"></i> Login</button>
          <button id="mobileProfileBtn" class="btn outline" style="display:none"><i class="fa fa-user"></i> Profile</button>
          <button id="mobileLogoutBtn" class="btn outline" style="display:none"><i class="fa fa-right-from-bracket"></i> Logout</button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Notification feed -->
  <div id="notifFeed" class="feed hidden">
  <div class="feed-toolbar">
    <span class="muted small-text">Notifications</span>
    <div style="color:var(--brand);display:flex;gap:.25rem;">
      <button id="markAllReadBtn" class='btn ' style="color:var(--brand);" ><i class="fa fa-check-double"></i> Mark as Read</button>
      <button id="clearAllNotifBtn" class='btn '><i class="fa fa-trash"></i> Clear</button>
    </div>
  </div>
  <div id="notifList" class="list"></div>
</div>
<script type="module" src="/src/js/notifications.js"></script>
  

  <main class="container">
    <section class="page-grid">
      <!-- Left: contact form -->
      <article class="card">
        <div class="body">
          <h1 class="page-title">Contact us</h1>
          <p class="muted">
            Tell us what you need help with — visa, Work & Pay, flights, or anything travel related. Your message is securely logged
            so our team can follow up quickly.
          </p>
          <div style="margin-top:.5rem;">
            <span class="pill-soft">
              <i class="fa fa-shield-check"></i>
              Messages are stored securely and visible to our admin support team only.
            </span>
          </div>

          <form class="list" id="contactForm" novalidate>
            <div>
              <div class="field-label">Full name</div>
              <input class="input" name="fullname" id="fullnameInput" placeholder="Full name" autocomplete="name" required>
              <div id="nameError" class="error-text"></div>
            </div>
            <div>
              <div class="field-label">Email</div>
              <input class="input" name="email" id="emailInput" type="email" placeholder="Email" autocomplete="email" required>
              <div id="emailError" class="error-text"></div>
            </div>
            <div>
              <div class="field-label">Subject</div>
              <input class="input" name="subject" id="subjectInput" placeholder="What is this about? (e.g. Canada Work & Pay, Schengen visa)">
            </div>
            <div>
              <div class="field-label">Message</div>
              <textarea class="textarea" name="message" id="messageInput" placeholder="Your message" required></textarea>
              <div id="messageError" class="error-text"></div>
            </div>

            <!-- Hidden fields -->
            <input type="hidden" name="source" id="sourceField" value="contact-page">
            <input type="hidden" name="ts" id="tsField" value="">

            <div class="toolbar" style="justify-content:space-between;flex-wrap:wrap;margin-top:.4rem;">
              <span id="cMsg" class="hint small-text"></span>
              <button class="btn brand" type="submit" id="contactSubmit">
                <i class="fa fa-paper-plane"></i> Send
              </button>
            </div>
          </form>
        </div>
      </article>

      <!-- Right: contact info / help -->
      <aside class="card">
        <div class="body">
          <h3>Reach us directly</h3>
          <p class="muted small-text">
            Prefer direct contact? Use the details below. For best tracking and follow‑up, we still recommend sending a message via the form.
          </p>

          <div class="contact-info" aria-label="Contact information">
            <div>
              <i class="fa fa-phone"></i>
              <div>
                <strong>Phone</strong><br>
                +233 59 911 7007<br>
                <span class="muted small-text">Mon – Sat, 9:00am – 6:00pm</span>
              </div>
            </div>
            <div>
              <i class="fa fa-envelope"></i>
              <div>
                <strong>Email</strong><br>
                info@elitetravel.com<br>
                <span class="muted small-text">We respond within 24–48 hours.</span>
              </div>
            </div>
            <div>
              <i class="fa fa-map-marker-alt"></i>
              <div>
                <strong>Office</strong><br>
                Adabraka Akasanoma rd, Greater Accra, Ghana<br>
                <span class="muted small-text">Visit by appointment for in‑person consultations.</span>
              </div>
            </div>
          </div>

          <div style="margin-top:1.1rem;">
            <h4>What to include in your message</h4>
            <ul class="small-text muted" style="padding-left:1rem;margin-top:.3rem;">
              <li>Your destination country and target date.</li>
              <li>Whether you’re asking about visa, Work & Pay, or flights.</li>
              <li>Any previous attempts or refusals (if applicable).</li>
            </ul>
          </div>
        </div>
      </aside>
    </section>
  </main>

  <!-- Footer -->
  <footer id="footer">
    <div class="grid">
      <div>
        <h4>Elite Travel & Tour</h4>
        <p>Trusted partner for seamless journeys worldwide.</p>
        <p class="muted">Visa assistance, Work & Pay programs, and flight bookings with premium support.</p>
      </div>
      <div>
        <h4>Quick Links</h4>
        <ul>
          <li><a href="/views/pages/services.html">Services</a></li>
          <li><a href="/views/pages/work-and-pay.html">Work & Pay</a></li>
          <li><a href="/views/pages/appointment.html">Book Appointment</a></li>
          <li><a href="/views/pages/contact.html">Contact</a></li>
          <li><a href="/views/pages/about.html">About</a></li>
        </ul>
      </div>
      <div>
        <h4>Contact</h4>
        <p><i class="fa fa-phone"></i> +233 59 911 7007</p>
        <p><i class="fa fa-envelope"></i> info@elitetravel.com</p>
        <p><i class="fa fa-map-marker-alt"></i> Adabraka Akasanoma rd, Greater Accra, Ghana</p>
        <div class="newsletter" style="margin-top:.5rem;">
          <label for="newsletterEmail" class="muted small-text">Subscribe to our newsletter:</label><br>
          <input id="newsletterEmail" type="email" placeholder="Your email">
          <button id="subscribeBtn" class="btn sm brand" style="margin-top:.25rem;">
            <i class="fa fa-paper-plane"></i> Subscribe
          </button>
        </div>
        <div id="subscribeMsg" class="muted small-text" style="margin-top:.35rem;"></div>
      </div>
      <div>
        <h4>Resources</h4>
        <ul class="list">
          <li><a href="/views/pages/profile.html">Profile</a></li>
          <li><a href="/views/pages/tracking.html">Tracking</a></li>
          <li><a href="/views/pages/privacy.html">Privacy Policy</a></li>
          <li><a href="/views/pages/terms.html">Terms of Service</a></li>
        </ul>
      </div>
      <div class="social">
        <h4>Follow Us</h4>
        <div class="toolbar">
          <a href="#"><i class="fa-brands fa-facebook"></i></a>
          <a href="#"><i class="fa-brands fa-x-twitter"></i></a>
          <a href="#"><i class="fa-brands fa-instagram"></i></a>
          <a href="#"><i class="fa-brands fa-linkedin"></i></a>
        </div>
      </div>
    </div>
    <div class="footer-bottom">© <span id="year"></span> Elite Travel & Tour. All rights reserved.</div>
  </footer>

  <!-- Confirmation Modal -->
  <div class="modal" id="confirmModal" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
    <section class="card"><div class="body">
      <h3 id="confirmTitle">Message sent</h3>
      <p id="confirmText" class="small-text"></p>
      <div class="toolbar" style="margin-top:.6rem;justify-content:flex-end;">
        <button class="btn brand" id="confirmOk"><i class="fa fa-check"></i> OK</button>
      </div>
    </div></section>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast" role="status" aria-live="polite">
    <i class="fa fa-info-circle"></i><span id="toastText">Notice</span>
  </div>

  <script type="module">
    import { sb } from '/src/js/supabase.js';

    // Dynamic year
    document.getElementById('year').textContent=new Date().getFullYear();

    // Newsletter
    const subscribeBtn=document.getElementById('subscribeBtn');
    const eemailInput=document.getElementById('newsletterEmail');
    const subscribeMsg=document.getElementById('subscribeMsg');
    subscribeBtn?.addEventListener('click',()=>{
      const eemail=eemailInput.value.trim();
      if(!eemail){
        subscribeMsg.textContent='Please enter your email.';
        subscribeMsg.style.color='red';
        return;
      }
      subscribeMsg.textContent=`Thank you for subscribing, ${eemail}!`;
      subscribeMsg.style.color='lightgreen';
      eemailInput.value='';
    });

    // Toast helper
    const toast=document.getElementById('toast');
    const toastText=document.getElementById('toastText');
    function showToast(message,ms=2500){
      if(!toast || !toastText) return;
      toastText.textContent=message;
      toast.classList.add('show');
      setTimeout(()=> toast.classList.remove('show'), ms);
    }

    // Notification feed toggle (uses notifications.js for content)
    document.addEventListener('click',(e)=>{
      const feed=document.getElementById('notifFeed');
      if(!feed) return;
      if(e.target.closest('#bellBtn')) feed.classList.toggle('hidden');
      else if(!e.target.closest('#notifFeed')) feed.classList.add('hidden');
    });

    // Auth buttons
    const loginBtn=document.getElementById('loginBtn');
    const logoutBtn=document.getElementById('logoutBtn');
    const profileBtn=document.getElementById('profileBtn');
    const mobileLoginBtn=document.getElementById('mobileLoginBtn');
    const mobileLogoutBtn=document.getElementById('mobileLogoutBtn');
    const mobileProfileBtn=document.getElementById('mobileProfileBtn');
    const authText=document.querySelector('#authStatus .auth-text');
    const authPill=document.getElementById('authStatus');
    const mobileAuthText=document.getElementById('mobileAuthText');

    function updateAuthUI(session){
      const user=session?.user;
      if(user){
        const label=user.email || 'User';
        authPill.style.display='none';
        authText.textContent=label;
        mobileAuthText.textContent=label;

        loginBtn.style.display='none';
        logoutBtn.style.display='inline-flex';
        profileBtn.style.display='inline-flex';

        mobileLoginBtn.style.display='none';
        mobileLogoutBtn.style.display='inline-flex';
        mobileProfileBtn.style.display='inline-flex';

        profileBtn.onclick=()=> window.location.href='/views/pages/profile.html';
        mobileProfileBtn.onclick=()=> window.location.href='/views/pages/profile.html';
      }else{
        authPill.style.display='none';
        authText.textContent='Guest';
        mobileAuthText.textContent='Guest';

        loginBtn.style.display='inline-flex';
        logoutBtn.style.display='none';
        profileBtn.style.display='none';

        mobileLoginBtn.style.display='inline-flex';
        mobileLogoutBtn.style.display='none';
        mobileProfileBtn.style.display='none';
      }
    }

    const { data:sessionData } = await sb.auth.getSession();
    updateAuthUI(sessionData.session);
    sb.auth.onAuthStateChange((_event,session)=> updateAuthUI(session));

    loginBtn?.addEventListener('click',()=> window.location.href='/views/pages/login.html');
    mobileLoginBtn?.addEventListener('click',()=> window.location.href='/views/pages/login.html');

    logoutBtn?.addEventListener('click',async()=>{
      await sb.auth.signOut();
      updateAuthUI(null);
      window.location.href='/views/pages/login.html';
    });
    mobileLogoutBtn?.addEventListener('click',async()=>{
      await sb.auth.signOut();
      updateAuthUI(null);
      window.location.href='/views/pages/login.html';
    });

    // Mobile menu
    const menuToggle=document.getElementById('menuToggle');
    const mobilePanel=document.getElementById('mobilePanel');
    menuToggle?.addEventListener('click',()=>{
      const isOpen=mobilePanel.classList.toggle('open');
      menuToggle.setAttribute('aria-expanded',String(isOpen));
    });
    mobilePanel?.addEventListener('click',(e)=>{
      if(e.target.matches('a')){
        mobilePanel.classList.remove('open');
        menuToggle.setAttribute('aria-expanded','false');
      }
    });

    // Contact form logic (Supabase contacts table)
    const contactForm=document.getElementById('contactForm');
    const fullnameInput=document.getElementById('fullnameInput');
    const emailInput=document.getElementById('emailInput');
    const subjectInput=document.getElementById('subjectInput');
    const messageInput=document.getElementById('messageInput');

    const nameError=document.getElementById('nameError');
    const emailError=document.getElementById('emailError');
    const messageError=document.getElementById('messageError');
    const cMsg=document.getElementById('cMsg');
    const contactSubmit=document.getElementById('contactSubmit');
    const tsField=document.getElementById('tsField');
    const sourceField=document.getElementById('sourceField');

    const confirmModal=document.getElementById('confirmModal');
    const confirmText=document.getElementById('confirmText');
    const confirmOk=document.getElementById('confirmOk');

    tsField.value=new Date().toISOString();
    sourceField.value=document.referrer ? 'ref:'+new URL(document.referrer).pathname : 'contact-page';

    function openConfirmModal(text){
      confirmText.textContent=text;
      confirmModal.style.display='flex';
    }
    function closeConfirmModal(){
      confirmModal.style.display='none';
    }
    confirmOk?.addEventListener('click',closeConfirmModal);
    confirmModal?.addEventListener('click',(e)=>{
      if(e.target===confirmModal) closeConfirmModal();
    });

    function validateContact(){
      let ok=true;
      nameError.textContent='';
      emailError.textContent='';
      messageError.textContent='';
      cMsg.textContent='';
      cMsg.className='hint small-text';

      if(!fullnameInput.value.trim()){
        nameError.textContent='Full name is required.';
        ok=false;
      }
      const emailVal=emailInput.value.trim();
      if(!emailVal || !emailVal.includes('@')){
        emailError.textContent='Valid email is required.';
        ok=false;
      }
      if(!messageInput.value.trim()){
        messageError.textContent='Please enter a message.';
        ok=false;
      }
      return ok;
    }

    contactForm.addEventListener('submit',async(e)=>{
      e.preventDefault();
      if(!validateContact()){
        cMsg.textContent='Please fix the highlighted fields.';
        cMsg.className='error-text small-text';
        return;
      }

      const full=fullnameInput.value.trim();
      const email=emailInput.value.trim();
      const subject=subjectInput.value.trim() || 'Contact form';
      const message=messageInput.value.trim();

      contactSubmit.disabled=true;
      contactSubmit.innerHTML='<i class="fa fa-spinner fa-spin"></i> Sending...';
      cMsg.textContent='Sending your message...';
      cMsg.className='hint small-text';

      try{
        const { data:currentSession } = await sb.auth.getSession();
        const user=currentSession.session?.user || null;

        const payload={
          name:full,
          email,
          subject,
          message,
          status:'new',
          notes:null,
          source:sourceField.value || 'contact-page',
          ts:new Date().toISOString(),
          user_id:user?.id || null
        };

        const { error } = await sb.from('contacts').insert(payload);
        if(error) throw error;

        cMsg.textContent='Message sent successfully. We will get back to you soon.';
        cMsg.className='success-text small-text';
        showToast('Message sent.');
        contactForm.reset();
        tsField.value=new Date().toISOString();

        openConfirmModal(`Thank you ${full}, your message has been sent. We’ll get back to you at ${email}.`);
      }catch(err){
        console.error('Failed to send contact message',err);
        cMsg.textContent='Failed to send message. Please try again later.';
        cMsg.className='error-text small-text';
        showToast('Failed to send message.',3000);
      }finally{
        contactSubmit.disabled=false;
        contactSubmit.innerHTML='<i class="fa fa-paper-plane"></i> Send';
      }
    });
  </script>
</body>
</html>
