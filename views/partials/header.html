
  <!-- Standard ICO -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">

<!-- Or PNG -->
<link rel="icon" href="/favicon.png" type="image/png">

<!-- Optional: SVG -->
<link rel="icon" href="/favicon.svg" type="image/svg+xml">
<style>
    
    
    :root{
      --brand:#0077cc;
      --brand-600:#0060a3;
      --brand-700:#004b80;
      --dark:#222;
      --light:#fff;
      --muted:#666;
      --bg:#f7f8fa;
      --gray-200:#e9ecef;
      --gray-300:#dee2e6;
      --shadow:0 8px 24px rgba(0,0,0,.08);
      --radius:12px;
      --success:#2e7d32;
      --danger:#c62828;
    }
    body { background:var(--bg); color:#222; }
    .container { max-width:1100px; margin:0 auto; padding:1rem; }
    .grid { display:block; }

    /* Nav */
    nav {
      position:sticky; top:0; background:#fff; z-index:1000;
      padding:.5rem 1rem; box-shadow:0 2px 4px rgba(0,0,0,0.08);
    }
    nav .wrap { display:flex; align-items:center; justify-content:space-between; gap:.75rem; }
    nav .logo { display:flex; align-items:center; gap:.5rem; font-weight:800; color:#222; text-decoration:none; white-space:nowrap; }
    nav .logo i { color:var(--brand); }
    nav ul.primary { display:flex; gap:1rem; list-style:none; margin:0; padding:0; }
    nav a { text-decoration:none; color:#333; font-weight:600; padding:.4rem .6rem; border-radius:6px; display:inline-flex; align-items:center; gap:.4rem; }
    nav a:hover, nav a.active { color:var(--brand); background:rgba(0,119,204,.08); }

    .btn { display:inline-flex; align-items:center; gap:.5rem; background:#222; color:#fff; padding:.55rem .85rem; border-radius:8px; text-decoration:none; border:none; cursor:pointer; font-weight:700; }
    .btn.brand { background:var(--brand); }
    .btn.brand:hover { background:var(--brand-600); }
    .btn.outline { background:transparent; color:#222; border:1px solid var(--gray-300); }
    .btn.outline:hover { border-color:var(--brand); color:var(--brand); }
    .btn[disabled]{ opacity:.55; cursor:not-allowed; }

    .auth-pill { display:inline-flex; align-items:center; gap:.5rem; padding:.35rem .6rem; border-radius:999px; background:#f0f7ff; color:#0b4d78; font-weight:600; border:1px solid #d6e9ff; max-width:50vw; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .auth-pill i { color:var(--brand); }

    .menu-toggle { display:none; border:none; background:#f7fbff; color:#09486f; padding:.5rem .6rem; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,.06) inset; }
    .menu-toggle i { font-size:1.1rem; }
    .mobile-panel { display:none; background:#fff; border:1px solid var(--gray-200); border-radius:10px; margin-top:.5rem; box-shadow:var(--shadow); overflow:hidden; }
    .mobile-panel.open { display:block; }
    .mobile-panel .block { display:flex; flex-direction:column; padding:.75rem; gap:.25rem; }
    .mobile-panel a { padding:.6rem .75rem; border-radius:8px; color:#222; font-weight:600; }
    .mobile-panel a:hover { background:#f7f9fc; color:var(--brand); }
    @media (max-width:880px){
      nav ul.primary{ display:none; }
      .menu-toggle{ display:inline-flex; }
      .auth-pill{ display:none; }
    }
    .actions { display:flex; gap:.5rem; align-items:center; }
    .bell { position:relative; }
    .count { position:absolute; top:-6px; right:-6px; background:#e00; color:#fff; font-size:.7rem; border-radius:50%; padding:0 5px; }
    .hidden { display:none !important; }
    /* Card and inputs */
    .card { background:#fff; border:1px solid var(--gray-200); border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden; }
    .card .body { padding:1rem; }
    .page-title { font-size:1.8rem; margin-bottom:.75rem; }
    .muted { color:var(--muted); }
    .list { display:block; }
    /* Toast */
    .toast {
      position:fixed; bottom:20px; left:50%; transform:translateX(-50%);
      background:#1b2a3a; color:#eaf4ff; padding:.75rem 1rem; border-radius:8px;
      box-shadow:var(--shadow); z-index:2000; display:none; max-width:90vw;
    }
    .toast.show { display:flex; align-items:center; gap:.6rem; }
    .toast i { color:#4fc3f7; }
    #notifFeed { background:#fff; border:1px solid #ddd; box-shadow:0 4px 12px rgba(0,0,0,.1); position:absolute; right:1rem; top:60px; width:260px; border-radius:8px; }
    #notifFeed h4 { margin:.5rem; font-size:1rem; }
    #notifList { max-height:200px; overflow-y:auto; }
    #notifList .item { padding:.5rem; border-bottom:1px solid #eee; }
    #notifList .item:last-child { border-bottom:none; }
    /* Responsive */
    @media (max-width:700px){
      .form-grid { grid-template-columns:1fr; }
    }
  </style>
  <nav aria-label="Primary">
  <div class="wrap">
    <a class="logo" href="/"><i class="fa-solid fa-compass"></i> Elite Travel & Tour</a>
    <ul class="primary">
      <li><a href="/views/pages/index.html"><i class="fa fa-house"></i> Home</a></li>
      <li><a href="/views/pages/services.html"><i class="fa fa-suitcase"></i> Services</a></li>
      <li><a href="/views/pages/work-and-pay.html"><i class="fa fa-briefcase"></i> Work & Pay</a></li>
      <li><a href="/views/pages/appointment.html" class="active"><i class="fa fa-calendar"></i> Book</a></li>
      <li><a href="/views/pages/contact.html"><i class="fa fa-envelope"></i> Contact</a></li>
      <li><a href="/views/pages/about.html"><i class="fa fa-circle-info"></i> About</a></li>
    </ul>
    <div class="nav-right">
      <button id="bellBtn" class="btn outline bell" aria-label="Notifications">
        <i class="fa-regular fa-bell"></i>
        <span id="bellCount" class="count hidden">0</span>
      </button>
      <span id="authStatus" class="auth-pill" style="display:none;">
        <i class="fa fa-user-check"></i><span class="auth-text">Guest</span>
      </span>
      <button id="loginBtn" class="btn outline"><i class="fa fa-right-to-bracket"></i> Login</button>
      <button id="profileBtn" class="btn outline" style="display:none"><i class="fa fa-user"></i> Profile</button>
      <button id="logoutBtn" class="btn outline" style="display:none"><i class="fa fa-right-from-bracket"></i> Logout</button>
      <button id="menuToggle" class="menu-toggle" aria-expanded="false"><i class="fa fa-bars"></i></button>
    </div>
  </div>

  <!-- Mobile panel -->
  <div id="mobilePanel" class="mobile-panel">
    <div class="block">
      <a href="/views/pages/index.html"><i class="fa fa-house"></i> Home</a>
      <a href="/views/pages/services.html"><i class="fa fa-suitcase"></i> Services</a>
      <a href="/views/pages/work-and-pay.html"><i class="fa fa-briefcase"></i> Work & Pay</a>
      <a href="/views/pages/appointment.html" class="active"><i class="fa fa-calendar"></i> Book</a>
      <a href="/views/pages/contact.html"><i class="fa fa-envelope"></i> Contact</a>
      <a href="/views/pages/about.html"><i class="fa fa-circle-info"></i> About</a>
    </div>
    <div class="block">
      <span class="auth-pill"><i class="fa fa-user"></i><span id="mobileAuthText">Guest</span></span>
      <div class="toolbar">
        <button id="mobileLoginBtn" class="btn brand"><i class="fa fa-right-to-bracket"></i> Login</button>
        <button id="mobileProfileBtn" class="btn outline" style="display:none"><i class="fa fa-user"></i> Profile</button>
        <button id="mobileLogoutBtn" class="btn outline" style="display:none"><i class="fa fa-right-from-bracket"></i> Logout</button>
      </div>
    </div>
  </div>
</nav>

<div id="notifFeed" class="feed hidden">
  <h4>Notifications</h4>
  <div id="notifList" class="list"></div>
</div>

<!-- Toast -->
<div id="toast" class="toast" role="status" aria-live="polite">
  <i class="fa fa-info-circle"></i><span id="toastText"></span>
</div>

<script type="module"> import { sb } from '/js/supabase.js';
 

  /* Notification feed toggle */
  document.addEventListener('click',(e)=>{
    const feed=document.getElementById('notifFeed');
    if(!feed) return;
    if(e.target.closest('#bellBtn')){ feed.classList.toggle('hidden'); }
    else if(!e.target.closest('#notifFeed')){ feed.classList.add('hidden'); }
  });

  /* Supabase notifications subscription */
  function renderNotification(n){
    const list=document.getElementById('notifList');
    const bellCount=document.getElementById('bellCount');
    if(list){
      const el=document.createElement('div');
      el.className='item';
      el.textContent=n.message || n.text;
      list.prepend(el);
    }
    if(bellCount){
      const count=parseInt(bellCount.textContent||'0',10)+1;
      bellCount.textContent=String(count);
      bellCount.classList.remove('hidden');
    }
  }

  let channel;
  async function subscribeNotifications(userId){
    if(channel){ await sb.removeChannel(channel); channel=null; }
    channel=sb.channel(`header-notifs-${userId}`)
      .on('postgres_changes',{
        event:'INSERT',
        schema:'public',
        table:'notifications',
        filter:`user_id=eq.${userId}`
      },payload=>{
        renderNotification(payload.new);
      })
      .subscribe();
  }

  /* Auth buttons */
  const loginBtn=document.getElementById('loginBtn');
  const logoutBtn=document.getElementById('logoutBtn');
  const profileBtn=document.getElementById('profileBtn');
  const mobileLoginBtn=document.getElementById('mobileLoginBtn');
  const mobileLogoutBtn=document.getElementById('mobileLogoutBtn');
  const mobileProfileBtn=document.getElementById('mobileProfileBtn');
  const authText=document.querySelector('#authStatus .auth-text');
  const mobileAuthText=document.getElementById('mobileAuthText');

  function updateAuthUI(session){
    const user=session?.user;
    if(user){
      authText.textContent=user.email;
      document.getElementById('authStatus').style.display='inline-flex';
      mobileAuthText.textContent=user.email;

      loginBtn.style.display='none';
      logoutBtn.style.display='inline-flex';
      profileBtn.style.display='inline-flex';

      mobileLoginBtn.style.display='none';
      mobileLogoutBtn.style.display='inline-flex';
      mobileProfileBtn.style.display='inline-flex';

      profileBtn.onclick=()=>window.location.href=`/views/pages/user/profile.html?id=${user.id}`;
      mobileProfileBtn.onclick=()=>window.location.href=`/views/pages/user/profile.html?id=${user.id}`;

      subscribeNotifications(user.id);
    } else {
      authText.textContent='Guest';
      document.getElementById('authStatus').style.display='none';
      mobileAuthText.textContent='Guest';

      loginBtn.style.display='inline-flex';
      logoutBtn.style.display='none';
      profileBtn.style.display='none';

      mobileLoginBtn.style.display='inline-flex';
      mobileLogoutBtn.style.display='none';
      mobileProfileBtn.style.display='none';
    }
  }

  // Initial session check
  const { data } = await sb.auth.getSession();
  updateAuthUI(data.session);

  // Listen for auth changes
  sb.auth.onAuthStateChange((_event, session)=>{
    updateAuthUI(session);
  });

  // Login buttons redirect to login page
  loginBtn.addEventListener('click', ()=> window.location.href='/views/pages/login.html');
  mobileLoginBtn.addEventListener('click', ()=> window.location.href='/views/pages/login.html');

  // Logout buttons sign out via Supabase
  logoutBtn.addEventListener('click', async ()=>{
    await sb.auth.signOut();
    updateAuthUI(null);
    window.location.href='/views/pages/login.html';
    });
    mobileLogoutBtn.addEventListener('click', async ()=>{
    await sb.auth.signOut();
    updateAuthUI(null);
    window.location.href='/views/pages/login.html';
  });

  /* =========================================
     Toast notifications
  ========================================== */
  const toast = document.getElementById('toast');
  const toastText = document.getElementById('toastText');
  function showToast(message, ms=2500){
    toastText.textContent = message;
    toast.classList.add('show');
    setTimeout(()=> toast.classList.remove('show'), ms);
  }

  /* =========================================
     Mobile menu toggle
  ========================================== */
  const menuToggle = document.getElementById('menuToggle');
  const mobilePanel = document.getElementById('mobilePanel');
  menuToggle.addEventListener('click', ()=>{
    const isOpen = mobilePanel.classList.toggle('open');
    menuToggle.setAttribute('aria-expanded', String(isOpen));
  });
  mobilePanel.addEventListener('click', (e)=>{
    if(e.target.matches('a')) {
      mobilePanel.classList.remove('open');
      menuToggle.setAttribute('aria-expanded','false');
    }
  });
</script>

